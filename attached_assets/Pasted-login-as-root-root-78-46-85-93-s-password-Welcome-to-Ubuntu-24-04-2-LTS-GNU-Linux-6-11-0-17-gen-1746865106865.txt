login as: root
root@78.46.85.93's password:
Welcome to Ubuntu 24.04.2 LTS (GNU/Linux 6.11.0-17-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Sat May 10 08:10:44 AM UTC 2025

  System load:             0.98
  Usage of /:              1.8% of 467.52GB
  Memory usage:            1%
  Swap usage:              0%
  Temperature:             41.9 C
  Processes:               273
  Users logged in:         0
  IPv4 address for enp6s0: 78.46.85.93
  IPv6 address for enp6s0: 2a01:4f8:120:1345::2


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


*** System restart required ***
Last login: Sat May 10 07:36:36 2025 from 152.59.46.225
root@d026e9724:~# sudo nano /etc/postgresql/*/main/pg_hba.conf
root@d026e9724:~# # Switch to postgres system user (which has permissions to create users)
sudo -u postgres psql -c "DROP USER IF EXISTS neondb_owner;"
sudo -u postgres psql -c "CREATE USER neondb_owner WITH PASSWORD 'npg_U8evoXZz0WOB' SUPERUSER;"
sudo -u postgres psql -c "DROP DATABASE IF EXISTS neondb;"
sudo -u postgres psql -c "CREATE DATABASE neondb OWNER neondb_owner;"
sudo -u postgres psql -c "GRANT ALL PRIVILEGES ON DATABASE neondb TO neondb_owner;"
sudo -u postgres psql -d neondb -c "GRANT ALL ON SCHEMA public TO neondb_owner;"
NOTICE:  role "neondb_owner" does not exist, skipping
DROP ROLE
CREATE ROLE
NOTICE:  database "neondb" does not exist, skipping
DROP DATABASE
CREATE DATABASE
GRANT
GRANT
root@d026e9724:~# cd /cd /var/www/UrlCampaignTracker^C
root@d026e9724:~# cd /var/www/UrlCampaignTracker
root@d026e9724:/var/www/UrlCampaignTracker# # Switch to postgres system user (which has permissions to create users)
sudo -u postgres psql -c "DROP USER IF EXISTS neondb_owner;"
sudo -u postgres psql -c "CREATE USER neondb_owner WITH PASSWORD 'npg_U8evoXZz0WOB' SUPERUSER;"
sudo -u postgres psql -c "DROP DATABASE IF EXISTS neondb;"
sudo -u postgres psql -c "CREATE DATABASE neondb OWNER neondb_owner;"
sudo -u postgres psql -c "GRANT ALL PRIVILEGES ON DATABASE neondb TO neondb_owner;"
sudo -u postgres psql -d neondb -c "GRANT ALL ON SCHEMA public TO neondb_owner;"
ERROR:  role "neondb_owner" cannot be dropped because some objects depend on it
DETAIL:  owner of database neondb
1 object in database neondb
ERROR:  role "neondb_owner" already exists
DROP DATABASE
CREATE DATABASE
GRANT
GRANT
root@d026e9724:/var/www/UrlCampaignTracker# # Try connecting with the new credentials
export PGPASSWORD=npg_U8evoXZz0WOB
psql -h localhost -U neondb_owner -d neondb -c "SELECT 1 as connection_test;"
 connection_test
-----------------
               1
(1 row)

root@d026e9724:/var/www/UrlCampaignTracker# # Make sure postgres is listening on localhost
sudo nano /etc/postgresql/*/main/postgresql.conf

# Find the line that says "listen_addresses" and ensure it's:
# listen_addresses = 'localhost'          # what IP address(es) to listen on;

# Save the file (Ctrl+O, Enter, Ctrl+X)

# Edit pg_hba.conf again to ensure all authentication is md5
sudo nano /etc/postgresql/*/main/pg_hba.conf

# Make sure local connections use md5:
# TYPE  DATABASE        USER            ADDRESS                 METHOD
# "local" is for Unix domain socket connections only
local   all             all                                     md5
# IPv4 local connections:
host    all             all             127.0.0.1/32            md5
# IPv6 local connections:
host    all             all             ::1/128                 md5

# Save the file

# Reload PostgreSQL configuration without restarting
sudo -u postgres psql -c "SELECT pg_reload_conf();"

# Restart PostgreSQL to be safe
sudo systemctl restart postgresql
-bash: local: can only be used in a function
host: couldn't get address for 'all': failure
host: couldn't get address for 'all': failure
 pg_reload_conf
----------------
 t
(1 row)

root@d026e9724:/var/www/UrlCampaignTracker# ^C
root@d026e9724:/var/www/UrlCampaignTracker# sudo systemctl restart postgresql
root@d026e9724:/var/www/UrlCampaignTracker# # Check if the database dump exists
cd /var/www/UrlCampaignTracker
ls -la *database*.sql

# Import the database (use whichever file exists)
export PGPASSWORD=npg_U8evoXZz0WOB
psql -h localhost -U neondb_owner -d neondb < database_dump.sql

# Verify the import worked
psql -h localhost -U neondb_owner -d neondb -c "SELECT COUNT(*) FROM urls;"
-rw-r--r-- 1 root root 251426 May 10 08:06 database_dump.sql
SET
SET
SET
SET
SET
 set_config
------------

(1 row)

SET
SET
SET
SET
CREATE TYPE
ALTER TYPE
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
CREATE FUNCTION
ALTER FUNCTION
SET
SET
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE TABLE
ALTER TABLE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER SEQUENCE
ALTER SEQUENCE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
COPY 16
COPY 18
COPY 1
COPY 109
COPY 2
COPY 0
COPY 4
COPY 2
COPY 161
COPY 1
COPY 0
COPY 3
COPY 4
COPY 0
COPY 1
COPY 0
COPY 0
COPY 157
COPY 1
COPY 602
COPY 16
 setval
--------
     16
(1 row)

 setval
--------
     18
(1 row)

 setval
--------
      1
(1 row)

 setval
--------
    109
(1 row)

 setval
--------
      2
(1 row)

 setval
--------
   8710
(1 row)

 setval
--------
      4
(1 row)

 setval
--------
      2
(1 row)

 setval
--------
    160
(1 row)

 setval
--------
      3
(1 row)

 setval
--------
      4
(1 row)

 setval
--------
      1
(1 row)

 setval
--------
      1
(1 row)

 setval
--------
     33
(1 row)

 setval
--------
      1
(1 row)

 setval
--------
    158
(1 row)

 setval
--------
      3
(1 row)

 setval
--------
    653
(1 row)

 setval
--------
     16
(1 row)

ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE TRIGGER
CREATE TRIGGER
CREATE TRIGGER
CREATE TRIGGER
CREATE TRIGGER
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE
ERROR:  role "neon_superuser" does not exist
ERROR:  role "neon_superuser" does not exist
 count
-------
   157
(1 row)

root@d026e9724:/var/www/UrlCampaignTracker# # Update the db.ts file with the proper local connection
cat > /var/www/UrlCampaignTracker/server/db.# Update the db.ts file with the proper local connection
cat > /var/www/UrlCampaignTracker/server/db.ts << 'EOF'
import { Pool } from '@neondatabase/serverless';less';
import { drizzle } from 'drizzle-orm/neon-serverless';
import * as schema from "@shared/schema";
// Check for DATABASE_URL
// Check for DATABASE_URL_URL) {
if (!process.env.DATABASE_URL) {
  throw new Error(must be set. Did you forget to provision a database?",
    "DATABASE_URL must be set. Did you forget to provision a database?",
  );
}
console.log("Connecting to database:", process.env.DATABASE_URL.replace(/:[^:@]+@/, ":***@"));
console.log("Connecting to database:", process.env.DATABASE_URL.replace(/:[^:@]+@/, ":***@"));
// Create PostgreSQL pool with local connection
// Create PostgreSQL pool with local connection
export const pool = new Pool({ .DATABASE_URL
  connectionString: process.env.DATABASE_URL
});
// Test connection on startup
// Test connection on startup
pool.query('SELECT 1')log('✅ Database connection successful'))
  .then(() => console.log('✅ Database connection successful'))err));
  .catch(err => console.error('❌ Database connection error:', err));
// Create drizzle orm instance
// Create drizzle orm instanceient: pool, schema });
export const db = drizzle({ client: pool, schema });
EOF
# Update the environment file with the correct database URL
# Update the environment file with the correct database URL
cat > /var/www/UrlCampaignTracker/.env << 'EOF'Zz0WOB@localhost:5432/neondb
DATABASE_URL=postgres://neondb_owner:npg_U8evoXZz0WOB@localhost:5432/neondb
API_SECRET_KEY=TraffiCS10928hc87jhkGXDe02jgn2eyV0qr-9YA
YOUTUBE_API_KEY=AIzaSyBB2nPAhc87jhkGXDe02jgn2eyV0qr-9YA186cZUKQ4tQEQLwDesAuMDbDZwoFG/5pyP/43tbnRIpwoQ==
SESSION_SECRET=2DcFsEodeYl7m0bq35CxJiW/hZI/J4dZhv9xrKiH186cZUKQ4tQEQLwDesAuMDbDZwoFG/5pyP/43tbnRIpwoQ==
PGHOST=localhost
PGPORT=5432db_owner
PGUSER=neondb_owneroXZz0WOB
PGPASSWORD=npg_U8evoXZz0WOB
PGDATABASE=neondbon
NODE_ENV=production
PORT=50000.0
HOST=0.0.0.0*
CORS_ORIGIN=*
EOF
root@d026e9724:/var/www/UrlCampaignTracker# # Stop the current application
pm2 stop url-management

# Start it again with the new configuration
cd /var/www/UrlCampaignTracker
pm2 start npm --name "url-management" -- run dev

# Check the logs to see if database connection is successful
pm2 logs url-management --lines 50
[PM2] Applying action stopProcessId on app [url-management](ids: [ 0 ])
[PM2] [url-management](0) ✓
┌────┬───────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name              │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
├────┼───────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤
│ 0  │ url-management    │ default     │ 1.0.0   │ fork    │ 0        │ 0      │ 2    │ stopped   │ 0%       │ 0b       │ root     │ disabled │
└────┴───────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘
[PM2] Starting /usr/bin/npm in fork_mode (1 instance)
[PM2] Done.
┌────┬───────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name              │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
├────┼───────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤
│ 0  │ url-management    │ default     │ 1.0.0   │ fork    │ 0        │ 0      │ 2    │ stopped   │ 0%       │ 0b       │ root     │ disabled │
│ 1  │ url-management    │ default     │ N/A     │ fork    │ 24517    │ 0s     │ 0    │ online    │ 0%       │ 15.2mb   │ root     │ disabled │
└────┴───────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘
[TAILING] Tailing last 50 lines for [url-management] process (change the value with --lines option)
/root/.pm2/logs/url-management-error.log last 50 lines:
0|url-mana |     syscall: 'connect',
0|url-mana |     address: '127.0.0.1',
0|url-mana |     port: 443
0|url-mana |   },
0|url-mana |   [Symbol(kMessage)]: 'connect ECONNREFUSED 127.0.0.1:443'
0|url-mana | }
0|url-mana | Error in automatic multiplier verification: ErrorEvent {
0|url-mana |   [Symbol(kTarget)]: WebSocket {
0|url-mana |     _events: [Object: null prototype] {
0|url-mana |       error: [Function],
0|url-mana |       message: [Function],
0|url-mana |       close: [Function],
0|url-mana |       open: [Function]
0|url-mana |     },
0|url-mana |     _eventsCount: 4,
0|url-mana |     _maxListeners: undefined,
0|url-mana |     _binaryType: 'arraybuffer',
0|url-mana |     _closeCode: 1006,
0|url-mana |     _closeFrameReceived: false,
0|url-mana |     _closeFrameSent: false,
0|url-mana |     _closeMessage: <Buffer >,
0|url-mana |     _closeTimer: null,
0|url-mana |     _errorEmitted: true,
0|url-mana |     _extensions: {},
0|url-mana |     _paused: false,
0|url-mana |     _protocol: '',
0|url-mana |     _readyState: 3,
0|url-mana |     _receiver: null,
0|url-mana |     _sender: null,
0|url-mana |     _socket: null,
0|url-mana |     _bufferedAmount: 0,
0|url-mana |     _isServer: false,
0|url-mana |     _redirects: 0,
0|url-mana |     _autoPong: true,
0|url-mana |     _url: 'wss://localhost/v2',
0|url-mana |     _req: null,
0|url-mana |     [Symbol(shapeMode)]: false,
0|url-mana |     [Symbol(kCapture)]: false
0|url-mana |   },
0|url-mana |   [Symbol(kType)]: 'error',
0|url-mana |   [Symbol(kError)]: Error: connect ECONNREFUSED 127.0.0.1:443
0|url-mana |       at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
0|url-mana |     errno: -111,
0|url-mana |     code: 'ECONNREFUSED',
0|url-mana |     syscall: 'connect',
0|url-mana |     address: '127.0.0.1',
0|url-mana |     port: 443
0|url-mana |   },
0|url-mana |   [Symbol(kMessage)]: 'connect ECONNREFUSED 127.0.0.1:443'
0|url-mana | }

/root/.pm2/logs/url-management-out.log last 50 lines:
0|url-mana | Initial calculated load value: 0.5625
0|url-mana | Applied minimum scaling factor for visibility: 1.7999999999999998
0|url-mana | Final system load calculation (before fallbacks): 2
0|url-mana | FINAL SYSTEM LOAD VALUE TO DISPLAY: 2
0|url-mana | ===========================================
0|url-mana | Final CPU details being set: {
0|url-mana |   "manufacturer": "AMD",
0|url-mana |   "brand": "AMD Ryzen 7 PRO 8700GE w/ Radeon 780M Graphics",
0|url-mana |   "speed": 0.4,
0|url-mana |   "cores": 16,
0|url-mana |   "physicalCores": 8
0|url-mana | }
0|url-mana | OS information: {
0|url-mana |   "platform": "linux",
0|url-mana |   "distro": "Ubuntu",
0|url-mana |   "release": "24.04.2 LTS",
0|url-mana |   "codename": "noble",
0|url-mana |   "kernel": "6.11.0-17-generic",
0|url-mana |   "arch": "x64",
0|url-mana |   "hostname": "d026e9724",
0|url-mana |   "fqdn": "d026e9724.fastvps-server.com",
0|url-mana |   "codepage": "UTF-8",
0|url-mana |   "logofile": "ubuntu",
0|url-mana |   "serial": "90519979119242d1841742b7df90eab3",
0|url-mana |   "build": "",
0|url-mana |   "servicepack": "",
0|url-mana |   "uefi": true
0|url-mana | }
0|url-mana | 8:16:20 AM [access] Access check for path: /public/api/v1/landing/not_integrated
0|url-mana | 8:16:20 AM [access] Access denied for path: /public/api/v1/landing/not_integrated - no valid session or API key
0|url-mana | 8:16:20 AM [access] Access check for path: /public/api/v1/landing/not_integrated
0|url-mana | 8:16:20 AM [access] Access denied for path: /public/api/v1/landing/not_integrated - no valid session or API key
0|url-mana | 8:16:20 AM [access] Access check for path: /public/api/v1/landing/not_integrated
0|url-mana | 8:16:20 AM [access] Access denied for path: /public/api/v1/landing/not_integrated - no valid session or API key
0|url-mana | 8:16:21 AM [access] Access check for path: /public/api/v1/landing/not_integrated
0|url-mana | 8:16:21 AM [access] Access denied for path: /public/api/v1/landing/not_integrated - no valid session or API key
0|url-mana | 8:16:21 AM [access] Access check for path: /public/api/v1/landing/not_integrated
0|url-mana | 8:16:21 AM [access] Access denied for path: /public/api/v1/landing/not_integrated - no valid session or API key
0|url-mana | 8:16:21 AM [access] Access check for path: /public/api/v1/landing/not_integrated
0|url-mana | 8:16:21 AM [access] Access denied for path: /public/api/v1/landing/not_integrated - no valid session or API key
0|url-mana | 8:16:21 AM [access] Access check for path: /public/api/v1/landing/not_integrated
0|url-mana | 8:16:21 AM [access] Access denied for path: /public/api/v1/landing/not_integrated - no valid session or API key
0|url-mana | 8:16:21 AM [access] Access check for path: /public/api/v1/landing/not_integrated
0|url-mana | 8:16:21 AM [access] Access denied for path: /public/api/v1/landing/not_integrated - no valid session or API key
0|url-mana | 8:16:22 AM [access] Access check for path: /public/api/v1/landing/not_integrated
0|url-mana | 8:16:22 AM [access] Access denied for path: /public/api/v1/landing/not_integrated - no valid session or API key
0|url-mana | 8:16:22 AM [access] Access check for path: /public/api/v1/landing/not_integrated
0|url-mana | 8:16:22 AM [access] Access denied for path: /public/api/v1/landing/not_integrated - no valid session or API key
0|url-mana | 8:16:22 AM [access] Access check for path: /public/api/v1/landing/not_integrated
0|url-mana | 8:16:22 AM [access] Access denied for path: /public/api/v1/landing/not_integrated - no valid session or API key

1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
1|url-management  | > rest-express@1.0.0 dev
1|url-management  | > NODE_ENV=development tsx server/index.ts
1|url-management  | /var/www/UrlCampaignTracker/server/db.ts:7
1|url-management  |   throw new Error(
1|url-management  |         ^
1|url-management  | Error: DATABASE_URL must be set. Did you forget to provision a database?
1|url-management  |     at <anonymous> (/var/www/UrlCampaignTracker/server/db.ts:7:9)
1|url-management  |     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
1|url-management  |     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
1|url-management  |     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
1|url-management  | Node.js v20.19.1
^C
root@d026e9724:/var/www/UrlCampaignTracker# # Test the API
curl http://localhost:5000/api/status
curl -H "X-API-Key: TraffiCS10928" http://localhost:5000/api/urls

# Check Nginx configuration to make sure it's properly proxying requests
cat /etc/nginx/sites-available/viralplayer.xyz

# Test the website through Nginx
curl -H "Host: viralplayer.xyz" http://localhost
curl: (7) Failed to connect to localhost port 5000 after 0 ms: Couldn't connect to server
curl: (7) Failed to connect to localhost port 5000 after 0 ms: Couldn't connect to server
server {
    listen 80;
    server_name viralplayer.xyz www.viralplayer.xyz localhost;

    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_cache_bypass $http_upgrade;
    }

    # Add error logs for debugging
    error_log /var/log/nginx/viralplayer-error.log debug;
    access_log /var/log/nginx/viralplayer-access.log;
}
<html>
<head><title>502 Bad Gateway</title></head>
<body>
<center><h1>502 Bad Gateway</h1></center>
<hr><center>nginx/1.24.0 (Ubuntu)</center>
</body>
</html>
root@d026e9724:/var/www/UrlCampaignTracker#
