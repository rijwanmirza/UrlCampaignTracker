root@vultr:~# rm fix-vps.sh
rm: cannot remove 'fix-vps.sh': No such file or directory
root@vultr:~# nano fix-vps.sh
root@vultr:~# chmod +x fix-vps.sh
./fix-vps.sh
╔══════════════════════════════════════════════════════════════╗
║               FINAL FIX FOR VPS DEPLOYMENT                   ║
╚══════════════════════════════════════════════════════════════╝

📦 Creating backup...
✓ Backup created at /root/url-campaign-final-backup-20250428070020
🛑 Stopping current processes...
[PM2] Applying action stopProcessId on app [all](ids: [ 0 ])
[PM2] [url-campaign](0) ✓
┌────┬─────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name            │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
├────┼─────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤
│ 0  │ url-campaign    │ default     │ 1.0.0   │ fork    │ 0        │ 0      │ 0    │ stopped   │ 0%       │ 0b       │ root     │ disabled │
└────┴─────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘
[PM2] Applying action deleteProcessId on app [all](ids: [ 0 ])
[PM2] [url-campaign](0) ✓
┌────┬───────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name      │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
└────┴───────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘
✓ All processes stopped
📝 Creating simplified startup script...
✓ Created simplified startup script
🔒 Disabling Nginx...
Synchronizing state of nginx.service with SysV service script with /lib/systemd/systemd-sysv-install.
Executing: /lib/systemd/systemd-sysv-install disable nginx
Removed /etc/systemd/system/multi-user.target.wants/nginx.service.
✓ Nginx disabled
🔍 Checking for processes using port 80...
✓ Port 80 cleared
🚀 Starting application directly on port 80...
✓ Application started with PID 3607
⏳ Waiting for application to initialize...
⚠️ Application failed to start
Checking logs...
file:///var/www/url-campaign/dist/index.js:272
      throw new Error(
            ^

Error: DATABASE_URL must be set. Did you forget to provision a database?
    at server/db.ts (file:///var/www/url-campaign/dist/index.js:272:13)
    at __init (file:///var/www/url-campaign/dist/index.js:4:56)
    at file:///var/www/url-campaign/dist/index.js:445:1
    at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
    at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)

Node.js v20.19.1
Trying alternative approach with PM2...
[PM2] Starting /var/www/url-campaign/start.sh in fork_mode (1 instance)
[PM2] Done.
┌────┬─────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name            │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
├────┼─────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤
│ 0  │ url-campaign    │ default     │ 1.0.0   │ fork    │ 3629     │ 0s     │ 0    │ online    │ 0%       │ 3.4mb    │ root     │ disabled │
└────┴─────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘
[PM2] Saving current process list...
[PM2] Successfully saved in /root/.pm2/dump.pm2
✓ Started application with PM2
🔍 Verifying application is responding...
✓ Application is responding on port 80
📊 Monitoring application...
root        3662 61.0  8.4 1051144 82280 ?       Rl   07:00   0:00 node dist/index.js
root        3676  0.0  0.2   6480  2272 pts/3    S+   07:00   0:00 grep node
./fix-vps.sh: line 134: netstat: command not found
✓ Application monitored
💾 Saving process information...
✓ Process information saved
╔══════════════════════════════════════════════════════════════╗
║                      FIX COMPLETED                           ║
╚══════════════════════════════════════════════════════════════╝

✓ Application deployed directly on port 80 (no Nginx)
✓ Backup created for rollback if needed

Your site should now be accessible at: http://views.yoyoprime.com
(Note: http:// not https:// since we bypassed Nginx)

If you still encounter issues:
1. Check application logs: cat /var/www/url-campaign/app.log
2. Try the alternative approach: cd /var/www/url-campaign && pm2 start start.sh --name url-campaign
3. To restore your previous setup: cp -r /root/url-campaign-final-backup-20250428070020/* /var/www/url-campaign/
root@vultr:~#
