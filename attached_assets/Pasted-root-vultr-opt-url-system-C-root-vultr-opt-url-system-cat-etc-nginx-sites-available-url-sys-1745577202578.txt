root@vultr:/opt/url-system# ^C
root@vultr:/opt/url-system# cat > /etc/nginx/sites-available/url-system << 'EOL'
server {
    listen 80;
    server_name _;

    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
EOL

ln -s /etc/nginx/sites-available/url-system /etc/nginx/sites-enabled/
rm -f /etc/nginx/sites-enabled/default
nginx -t
systemctl reload nginx
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
root@vultr:/opt/url-system# cat > /etc/systemd/system/url-system.service << 'EOL'
[Unit]
Description=URL Management System
After=network.target postgresql.service

[Service]
Environment=NODE_ENV=production
Environment=DATABASE_URL=postgres://urlapp:urlapp_password@localhost:5432/urlapp
Environment=PGUSER=urlapp
Environment=PGPASSWORD=urlapp_password
Environment=PGDATABASE=urlapp
Environment=PGHOST=localhost
Environment=PGPORT=5432
Type=simple
User=root
WorkingDirectory=/opt/url-system
ExecStart=/usr/bin/node dist/server/index.js
Restart=on-failure

[Install]
WantedBy=multi-user.target
EOL
root@vultr:/opt/url-system# systemctl enable url-system
systemctl start url-system
Created symlink /etc/systemd/system/multi-user.target.wants/url-system.service → /etc/systemd/system/url-system.service.
root@vultr:/opt/url-system# systemctl status url-system
× url-system.service - URL Management System
     Loaded: loaded (/etc/systemd/system/url-system.service; enabled; vendor preset: enabled)
     Active: failed (Result: exit-code) since Fri 2025-04-25 10:32:56 UTC; 7s ago
    Process: 18532 ExecStart=/usr/bin/node dist/server/index.js (code=exited, status=1/FAILURE)
   Main PID: 18532 (code=exited, status=1/FAILURE)
        CPU: 85ms

Apr 25 10:32:56 vultr systemd[1]: url-system.service: Main process exited, code=exited, status=1/FAILURE
Apr 25 10:32:56 vultr systemd[1]: url-system.service: Failed with result 'exit-code'.
Apr 25 10:32:56 vultr systemd[1]: url-system.service: Scheduled restart job, restart counter is at 5.
Apr 25 10:32:56 vultr systemd[1]: Stopped URL Management System.
Apr 25 10:32:56 vultr systemd[1]: url-system.service: Start request repeated too quickly.
Apr 25 10:32:56 vultr systemd[1]: url-system.service: Failed with result 'exit-code'.
Apr 25 10:32:56 vultr systemd[1]: Failed to start URL Management System.
root@vultr:/opt/url-system#
