root@vultr:~# nano fix-nginx-config.sh
root@vultr:~# chmod +x fix-nginx-config.sh
./fix-nginx-config.sh
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          FIX NGINX CONFIGURATION FOR 502 ERROR               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ Checking Nginx service status...
     Active: active (running) since Mon 2025-04-28 06:25:21 UTC; 22min ago
âœ“ Nginx service status checked
ğŸ“‹ Verifying application status with PM2...
â”‚ 0  â”‚ url-campaign    â”‚ default     â”‚ 1.0.0   â”‚ fork    â”‚ 2697     â”‚ 20m    â”‚ 0                                                                                 â”‚ online    â”‚ 0%       â”‚ 48.5mb   â”‚ root     â”‚ disabled â”‚
âœ“ Application status verified
ğŸ”Œ Checking ports that are listening...
LISTEN 0      511          0.0.0.0:80        0.0.0.0:*    users:(("nginx",pid=26                                                                             10,fd=6),("nginx",pid=2609,fd=6))
LISTEN 0      511          0.0.0.0:443       0.0.0.0:*    users:(("nginx",pid=26                                                                             10,fd=7),("nginx",pid=2609,fd=7))
LISTEN 0      511             [::]:80           [::]:*    users:(("nginx",pid=26                                                                             10,fd=9),("nginx",pid=2609,fd=9))
LISTEN 0      511             [::]:443          [::]:*    users:(("nginx",pid=26                                                                             10,fd=8),("nginx",pid=2609,fd=8))
âœ“ Listening ports checked
ğŸ”Œ Checking if port 5000 is being used...
./fix-nginx-config.sh: line 53: netstat: command not found
âš ï¸ Port 5000 is not being used by any process
Found process ID: 2697
./fix-nginx-config.sh: line 61: netstat: command not found
Process is not listening on any ports
ğŸ“ Creating fresh Nginx configuration...
Using default port 5000
Using Nginx configuration file: /etc/nginx/sites-available/default
âœ“ Backed up existing Nginx configuration
âœ“ Created fresh Nginx configuration and error pages
ğŸ” Validating Nginx configuration...
nginx: [warn] conflicting server name "views.yoyoprime.com" on 0.0.0.0:80, ignor                                                                             ed
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
âœ“ Nginx configuration is valid
ğŸ”„ Restarting Nginx...
âœ“ Nginx restarted successfully
ğŸ“ Creating test script to check Node.js application directly...
âœ“ Created test script at /tmp/test-app.sh
You can run this script to test connections:
/tmp/test-app.sh
ğŸ” Checking if the application is serving content...
âš ï¸ Application is not responding directly
Checking process status...
âœ“ Process is still running
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  NGINX FIX COMPLETED                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ A completely fresh Nginx configuration has been created
âœ“ Custom error pages have been set up

Your site should now be accessible at: https://views.yoyoprime.com

If you still encounter issues:
1. Check the application logs: pm2 logs url-campaign
2. Check Nginx error logs: tail -f /var/log/nginx/error.log
3. Test direct connection: /tmp/test-app.sh

If all else fails, you can restore from backup:
cp -r /root/url-campaign-backup-*/* /var/www/url-campaign/
sudo -u postgres psql postgres < /root/url-campaign-backup-*/database-*.sql
pm2 restart url-campaign
systemctl restart nginx
root@vultr:~#
